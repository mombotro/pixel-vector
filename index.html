<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azirona Vexel Edit</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div class="app-container">
        <!-- Settings Bar -->
        <div class="settings-bar">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div>
                    <h1 style="margin-bottom: 2px;">Azirona Vexel Edit</h1>
                    <div style="font-size: 10px; color: #94b0c2; font-style: italic;">Vector-based pixel art editor</div>
                </div>
                <div class="dropdown">
                    <button class="dropdown-btn">File ‚ñæ</button>
                    <div class="dropdown-content">
                        <button id="menu-save" title="Save (Ctrl+S)">Save (Ctrl+S)</button>
                        <button id="menu-load" title="Load">Load</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="menu-save-palette" title="Save Current Palette">Save Palette</button>
                        <button id="menu-load-palette" title="Load Palette">Load Palette</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="menu-export-png" title="Export as PNG">Export as PNG</button>
                        <button id="menu-export-jpg" title="Export as JPG">Export as JPG</button>
                        <button id="menu-export-gif" title="Export Animation as GIF">Export as GIF</button>
                        <button id="menu-export-spritesheet" title="Export Animation as Spritesheet">Export Spritesheet</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="menu-clear" title="Clear All">Clear</button>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropdown-btn">Edit ‚ñæ</button>
                    <div class="dropdown-content">
                        <button id="menu-undo" title="Undo (Ctrl+Z)">Undo (Ctrl+Z)</button>
                        <button id="menu-redo" title="Redo (Ctrl+Y)">Redo (Ctrl+Y)</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="menu-copy" title="Copy (Ctrl+C)">Copy (Ctrl+C)</button>
                        <button id="menu-paste" title="Paste (Ctrl+V)">Paste (Ctrl+V)</button>
                        <button id="menu-delete" title="Delete (Del)">Delete (Del)</button>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropdown-btn">View ‚ñæ</button>
                    <div class="dropdown-content">
                        <button id="view-left-panel">‚úì Left Toolbar</button>
                        <button id="view-color-palette">‚úì Color Palette</button>
                        <button id="view-shapes-panel">‚úì Shapes/History</button>
                        <button id="view-preview-panel">‚úì Preview</button>
                        <button id="view-timeline-panel">‚úì Timeline</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="view-toggle-grid">Toggle Grid (G)</button>
                        <button id="view-toggle-outline">Toggle Outline (O)</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button id="view-zen-mode">Zen Mode (Z)</button>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropdown-btn">Canvas ‚ñæ</button>
                    <div class="dropdown-content">
                        <button disabled style="opacity: 0.6; cursor: default; font-weight: bold;">Ratio</button>
                        <button id="canvas-ratio-1-1">‚óè 1:1 (Square)</button>
                        <button id="canvas-ratio-16-9">16:9</button>
                        <button id="canvas-ratio-4-3">4:3</button>
                        <button id="canvas-ratio-3-2">3:2</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button disabled style="opacity: 0.6; cursor: default; font-weight: bold;">Orientation</button>
                        <button id="canvas-orientation-landscape">‚óè Landscape</button>
                        <button id="canvas-orientation-portrait">Portrait</button>
                        <div style="border-top: 1px solid #1a1a2e; margin: 4px 0;"></div>
                        <button disabled style="opacity: 0.6; cursor: default; font-weight: bold;">Grid</button>
                        <button id="canvas-grid-off">Off</button>
                        <button id="canvas-grid-8">‚óè 8√ó8</button>
                        <button id="canvas-grid-16">16√ó16</button>
                        <button id="canvas-grid-32">32√ó32</button>
                        <button id="canvas-grid-64">64√ó64</button>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; margin-left: 10px;">
                    <span style="color: #00d9ff; font-size: 11px;">Zoom:</span>
                    <input type="number" id="zoom-percentage" min="50" max="500" step="50" value="100" style="width: 60px; padding: 4px; background: #16213e; border: 1px solid #533483; border-radius: 3px; color: #fff; font-family: 'Courier New', monospace; font-size: 11px;" title="Zoom percentage">
                    <span style="color: #888; font-size: 11px;">%</span>
                    <input type="range" id="zoom-slider" min="1" max="10" step="1" value="2" style="width: 100px; cursor: pointer;" title="Zoom slider">
                    <button id="zoom-preset-50" style="padding: 4px 8px; font-size: 10px;" title="50% zoom">50%</button>
                    <button id="zoom-preset-100" style="padding: 4px 8px; font-size: 10px;" title="100% zoom">100%</button>
                    <button id="zoom-preset-200" style="padding: 4px 8px; font-size: 10px;" title="200% zoom">200%</button>
                    <button id="zoom-preset-400" style="padding: 4px 8px; font-size: 10px;" title="400% zoom">400%</button>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <div id="save-status" style="font-size: 11px; color: #00d9ff; display: flex; align-items: center; gap: 5px;">
                    <span id="save-status-icon">üíæ</span>
                    <span id="save-status-text">Auto-save enabled</span>
                </div>
                <a href="https://ko-fi.com/A0A2CFZ3G" target="_blank" class="kofi-btn">‚òï Buy us a Mtn Dew</a>
                <button class="help-btn" id="helpBtn">Help</button>
            </div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Left Panel - Tools -->
            <div class="left-panel">
                <div class="tool-section">
                    <h3>Draw</h3>
                    <div class="tool-group">
                        <button id="tool-line" class="tool-btn active" title="Line (1)">Line (1)</button>
                        <button id="tool-rect" class="tool-btn" title="Rectangle (2)">Rect (2)</button>
                        <button id="tool-circle" class="tool-btn" title="Circle (3)">Circle (3)</button>
                        <button id="tool-oval" class="tool-btn" title="Oval (4)">Oval (4)</button>
                        <button id="tool-triangle" class="tool-btn" title="Triangle (5)">Triangle (5)</button>
                        <button id="tool-polygon" class="tool-btn" title="Polygon (6)">Polygon (6)</button>
                        <button id="tool-draw" class="tool-btn" title="Draw (D)">Draw (D)</button>
                        <button id="tool-select" class="tool-btn" title="Select (V)">Select (V)</button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Boolean</h3>
                    <div class="tool-group">
                        <button id="tool-union" title="Union (Ctrl+Shift+U)">Union</button>
                        <button id="tool-subtract" title="Subtract (Ctrl+Shift+B)">Subtract</button>
                        <button id="tool-intersect" title="Intersect (Ctrl+Shift+I)">Intersect</button>
                        <button id="tool-to-polygon" title="To Polygon (Ctrl+Shift+P)">To Poly</button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Nodes</h3>
                    <div class="tool-group">
                        <button id="tool-union-nodes" title="Merge Nodes (Ctrl+Shift+M)">Merge Nodes</button>
                        <button id="tool-simplify" title="Simplify Polygon (Ctrl+Shift+L)">Simplify</button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Groups</h3>
                    <div class="tool-group">
                        <button id="tool-create-group" title="Create Group from Selection (Ctrl+G)">Create Group</button>
                        <button id="tool-ungroup" title="Ungroup Selected (Ctrl+Shift+G)">Ungroup</button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Dither</h3>
                    <div style="margin-bottom: 8px;">
                        <select id="dither-pattern-select" style="width: 100%; padding: 6px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; cursor: pointer; margin-bottom: 8px;">
                            <option value="0">Pattern 1 (Solid)</option>
                            <option value="1">Pattern 2 (Light)</option>
                            <option value="2">Pattern 3</option>
                            <option value="3">Pattern 4</option>
                            <option value="4">Pattern 5</option>
                            <option value="5">Pattern 6</option>
                            <option value="6">Pattern 7</option>
                            <option value="7">Pattern 8</option>
                            <option value="8">Pattern 9</option>
                            <option value="9">Pattern 10</option>
                            <option value="10">Pattern 11</option>
                            <option value="11">Pattern 12</option>
                            <option value="12">Pattern 13</option>
                            <option value="13">Pattern 14</option>
                            <option value="14">Pattern 15</option>
                            <option value="15">Pattern 16</option>
                            <option value="16">Pattern 17</option>
                            <option value="17">Pattern 18</option>
                            <option value="18">Pattern 19 (Dense)</option>
                        </select>
                        <canvas id="ditherPatternPreview" width="64" height="64" style="width: 100%; height: auto; border: 1px solid #533483; image-rendering: pixelated; background: #1a1a2e;"></canvas>
                    </div>
                    <div style="margin-bottom: 8px;">
                        <label for="dither-scale" style="display: block; margin-bottom: 4px; font-size: 12px; color: #e94560;">Scale: <span id="dither-scale-value">8</span>x</label>
                        <input type="range" id="dither-scale" min="1" max="32" value="8" step="1" style="width: 100%;">
                    </div>
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; font-size: 12px; color: #e94560; cursor: pointer;">
                            <input type="checkbox" id="dither-invert" style="margin-right: 6px;">
                            Invert Pattern
                        </label>
                    </div>
                    <div class="tool-group">
                        <button id="tool-apply-dither" title="Apply Dither Pattern">Apply Dither</button>
                        <button id="tool-clear-dither" title="Clear Dither Pattern">Clear Dither</button>
                    </div>
                </div>
            </div>

            <!-- Center Area - Canvas -->
            <div class="center-area">
                <canvas id="canvas" width="480" height="272"></canvas>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Preview Panel -->
                <div class="preview-and-timeline">
                    <div class="preview-panel">
                        <h3>Preview <span id="preview-size" style="font-size: 9px; color: #888; font-weight: normal;"></span></h3>
                        <div class="preview-mode-buttons">
                            <button class="preview-mode-btn active" id="preview-actual">1:1</button>
                            <button class="preview-mode-btn" id="preview-repeat">Repeat</button>
                        </div>
                        <div class="preview-container">
                            <div class="preview-container-inner">
                                <canvas id="previewCanvas"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Timeline Panel -->
                    <div class="timeline-panel">
                        <div style="padding: 10px; background: #1a1a2e; border-bottom: 1px solid #533483;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <h3 style="margin: 0; color: #e94560; font-size: 13px;">Animation</h3>
                                <div style="display: flex; gap: 4px;">
                                    <button id="anim-play" title="Play/Pause" style="padding: 4px 12px; background: #533483; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 16px;">‚ñ∂</button>
                                    <button id="anim-stop" title="Stop" style="padding: 4px 12px; background: #533483; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 16px;">‚ñ†</button>
                                </div>
                            </div>
                            <div style="display: flex; gap: 6px; align-items: center; margin-bottom: 8px; flex-wrap: wrap;">
                                <label style="font-size: 11px; color: #e94560;">FPS:</label>
                                <input type="number" id="anim-fps" min="1" max="60" value="12" style="width: 40px; padding: 3px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 11px;">
                                <label style="font-size: 11px; color: #e94560;">Mode:</label>
                                <select id="anim-loop-mode" style="padding: 3px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 11px; cursor: pointer;">
                                    <option value="loop">Loop</option>
                                    <option value="bounce">Bounce</option>
                                    <option value="once">Once</option>
                                </select>
                            </div>
                            <div style="display: flex; gap: 6px; align-items: center; margin-bottom: 8px; flex-wrap: wrap;">
                                <label style="display: flex; align-items: center; font-size: 11px; color: #e94560; cursor: pointer; white-space: nowrap;">
                                    <input type="checkbox" id="anim-onion-skin" style="margin-right: 4px;">
                                    Onion
                                </label>
                                <label style="font-size: 11px; color: #e94560;">Fr:</label>
                                <input type="number" id="anim-onion-frames" min="1" max="5" value="1" style="width: 35px; padding: 3px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 11px;">
                                <label style="font-size: 11px; color: #e94560;">Op:</label>
                                <input type="number" id="anim-onion-opacity" min="10" max="90" value="30" step="10" style="width: 35px; padding: 3px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 11px;">
                            </div>
                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                <button id="anim-add-frame" title="Add Frame" style="flex: 1; padding: 6px; background: #533483; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">+ Frame</button>
                                <button id="anim-duplicate-frame" title="Duplicate Frame" style="flex: 1; padding: 6px; background: #533483; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Duplicate</button>
                                <button id="anim-delete-frame" title="Delete Frame" style="flex: 1; padding: 6px; background: #533483; color: #fff; border: none; border-radius: 3px; cursor: pointer; font-size: 11px;">Delete</button>
                            </div>
                        </div>
                        <div id="frame-thumbnails" style="display: flex; flex-direction: column; gap: 8px; padding: 10px; overflow-y: auto; max-height: 400px; background: #16213e;">
                            <!-- Frame thumbnails will be added here dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Side Panels -->
                <div class="side-panels">
                    <!-- Color Palette -->
                    <div class="panel-box" style="flex-shrink: 0;">
                        <h3>Color Palette</h3>

                        <!-- Canvas Background Color -->
                        <div style="padding: 8px; background: #16213e; border: 1px solid #533483; border-radius: 3px; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            <label for="background-color-picker" style="color: #94b0c2; font-size: 11px; flex: 1;">Canvas Background:</label>
                            <input type="color" id="background-color-picker" value="#0f3460" style="width: 50px; height: 28px; cursor: pointer; border: 1px solid #533483; border-radius: 3px; background: #1a1a2e;" title="Change background color">
                        </div>

                        <select id="palette-select" style="padding: 6px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px; font-family: 'Courier New', monospace; cursor: pointer; margin-bottom: 8px; width: 100%;">
                            <option value="16bit" selected>16-Bit Basic</option>
                            <option value="tic80">TIC-80</option>
                            <option value="pico8">Pico-8</option>
                            <option value="gameboy">Game Boy</option>
                            <option value="1bit">1-Bit (B&W)</option>
                            <option value="nes">NES</option>
                            <option value="c64">Commodore 64</option>
                            <option value="cga">CGA</option>
                            <option value="zxspectrum">ZX Spectrum</option>
                            <option value="appleii">Apple II</option>
                            <option value="amstradcpc">Amstrad CPC</option>
                            <option value="custom">Custom...</option>
                            <option value="lospec">Import from Lospec...</option>
                        </select>
                        <div class="color-palette" id="colorPalette"></div>
                    </div>

                    <!-- Shape Order / History Tabs -->
                    <div class="panel-box" style="flex: 1; min-height: 0; display: flex; flex-direction: column;">
                        <div class="tabs">
                            <button class="tab active" data-tab="shapes">Shapes</button>
                            <button class="tab" data-tab="history">History</button>
                        </div>
                        <div class="tab-content active" id="tab-shapes">
                            <div style="display: flex; gap: 4px; padding: 8px; border-bottom: 1px solid #1a1a2e;">
                                <button id="tool-bring-front" title="Bring to Front (])" style="flex: 1; padding: 4px; font-size: 16px;">‚¨Ü‚¨Ü</button>
                                <button id="tool-bring-forward" title="Bring Forward" style="flex: 1; padding: 4px; font-size: 16px;">‚¨Ü</button>
                                <button id="tool-send-backward" title="Send Backward" style="flex: 1; padding: 4px; font-size: 16px;">‚¨á</button>
                                <button id="tool-send-back" title="Send to Back ([)" style="flex: 1; padding: 4px; font-size: 16px;">‚¨á‚¨á</button>
                            </div>
                            <div class="shape-order-list" id="shapeOrderList"></div>
                        </div>
                        <div class="tab-content" id="tab-history">
                            <div class="history-list" id="historyList"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            A tool from the Azirona Drift - <a href="https://azirona.com" target="_blank" rel="noopener">azirona.com</a>
        </div>
    </div>

    <!-- Rename Modal -->
    <div id="renameModal" class="modal">
        <div class="modal-content">
            <h3>Rename Shape</h3>
            <input type="text" id="renameInput" placeholder="Enter shape name">
            <div class="modal-buttons">
                <button id="renameOk">OK</button>
                <button id="renameCancel">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content" style="min-width: 550px; max-height: 80vh; overflow-y: auto;">
            <h3>About Azirona Vexel Edit</h3>
            <div style="font-size: 11px; line-height: 1.6; margin-bottom: 15px; padding: 10px; background: #1a1a2e; border-left: 3px solid #00d9ff;">
                <strong style="color: #00d9ff;">Vector-Based Pixel Art Editor</strong><br>
                This tool combines the precision of vector graphics with the aesthetic of pixel art. Unlike traditional pixel editors that work with raster images, Vexel Edit uses vector shapes that snap to a pixel grid. This means you can easily edit, move, and manipulate your artwork without losing quality, while still achieving that perfect pixel-art look.
            </div>
            <h3>Tool Usage</h3>
            <div style="font-size: 11px; line-height: 1.6; margin-bottom: 20px;">
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Line Tool:</strong> Left-click to add points. Right-click to finish (near start point to close as polygon).
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Rectangle/Circle/Oval:</strong> Left-click to set first point, move mouse, left-click to set second point.
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Triangle:</strong> Left-click three times to place corners.
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Polygon:</strong> Left-click to add points. Right-click to finish (near start to close).
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Draw Tool:</strong> Click and drag to draw freehand. Auto-simplifies on release.
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Select Tool:</strong> Left-click shapes to select. Drag shapes to move. Drag nodes to edit. Right-click on edges to add nodes, on nodes to remove.
                </div>
                <div style="margin-bottom: 10px;">
                    <strong style="color: #00d9ff;">Rotation Mode (R):</strong> Click and drag the rotation handle to rotate selected shapes.
                </div>
            </div>
            <h3>Keyboard Shortcuts</h3>
            <div style="columns: 2; font-size: 11px; line-height: 1.8;">
                <div><kbd>1-6</kbd> Select drawing tools</div>
                <div><kbd>D</kbd> Freehand draw tool</div>
                <div><kbd>V</kbd> Select tool (move/edit)</div>
                <div><kbd>R</kbd> Toggle rotation mode</div>
                <div><kbd>Right-click</kbd> Add/remove nodes</div>
                <div><kbd>Ctrl+C</kbd> Copy selected shapes</div>
                <div><kbd>Ctrl+V</kbd> Paste shapes</div>
                <div><kbd>Del/Backspace</kbd> Delete shapes</div>
                <div><kbd>]</kbd> Bring to front</div>
                <div><kbd>[</kbd> Send to back</div>
                <div><kbd>Ctrl+Shift+U</kbd> Union</div>
                <div><kbd>Ctrl+Shift+B</kbd> Subtract</div>
                <div><kbd>Ctrl+Shift+I</kbd> Intersect</div>
                <div><kbd>Ctrl+Shift+P</kbd> To Polygon</div>
                <div><kbd>Ctrl+Shift+L</kbd> Simplify</div>
                <div><kbd>Ctrl+G</kbd> Create Group</div>
                <div><kbd>Ctrl+Shift+G</kbd> Ungroup</div>
                <div><kbd>Ctrl+Z</kbd> Undo</div>
                <div><kbd>Ctrl+S</kbd> Save to file</div>
                <div><kbd>H</kbd> Lock horizontal</div>
                <div><kbd>G</kbd> Toggle grid</div>
                <div><kbd>O</kbd> Toggle outline</div>
                <div><kbd>Z</kbd> Zen mode</div>
                <div><kbd>+</kbd> Zoom in</div>
                <div><kbd>-</kbd> Zoom out</div>
                <div><kbd>0</kbd> Reset zoom</div>
                <div><kbd>ESC</kbd> Cancel operation</div>
                <div><kbd>Shift+Click</kbd> Multi-select</div>
            </div>
            <div class="modal-buttons">
                <button id="helpClose">Close</button>
            </div>
        </div>
    </div>

    <!-- Export Options Modal -->
    <div id="exportModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h2 id="exportModalTitle">Export Options</h2>
            <div style="margin: 20px 0;">
                <label style="display: block; margin-bottom: 10px;">
                    <span style="display: block; margin-bottom: 5px; color: #e94560;">Scale:</span>
                    <input type="number" id="exportScale" min="1" max="16" value="1" style="width: 100%; padding: 8px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px;">
                    <span style="display: block; margin-top: 5px; font-size: 12px; color: #888;">Final size: <span id="exportSize">480 √ó 272</span> pixels</span>
                </label>
                <label style="display: block; margin-top: 15px; cursor: pointer;" id="exportTransparencyOption">
                    <input type="checkbox" id="exportTransparent" style="margin-right: 8px;">
                    <span>Transparent background</span>
                </label>
                <div id="exportGridOptions" style="display: none; margin-top: 15px;">
                    <label style="display: block; margin-bottom: 10px;">
                        <span style="display: block; margin-bottom: 5px; color: #e94560;">Grid Layout:</span>
                        <div style="display: flex; gap: 10px;">
                            <div style="flex: 1;">
                                <span style="display: block; margin-bottom: 5px; font-size: 12px; color: #888;">Columns:</span>
                                <input type="number" id="exportCols" min="1" max="20" value="1" style="width: 100%; padding: 8px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px;">
                            </div>
                            <div style="flex: 1;">
                                <span style="display: block; margin-bottom: 5px; font-size: 12px; color: #888;">Rows:</span>
                                <input type="number" id="exportRows" min="1" max="20" value="1" style="width: 100%; padding: 8px; background: #16213e; color: #fff; border: 1px solid #533483; border-radius: 3px;">
                            </div>
                        </div>
                        <span style="display: block; margin-top: 5px; font-size: 12px; color: #888;" id="exportGridInfo"></span>
                    </label>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="exportConfirm" style="background: #e94560;">Export</button>
                <button id="exportCancel">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Custom Palette Modal -->
    <div id="customPaletteModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3>Custom Palette</h3>
            <div style="margin: 15px 0;">
                <p style="font-size: 11px; color: #94b0c2; margin-bottom: 10px;">Click on any color to edit it. Click the √ó to remove a color. Use + to add colors.</p>
                <div id="customPaletteGrid" style="display: grid; grid-template-columns: repeat(8, 40px); gap: 5px; margin-bottom: 15px;"></div>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <button id="addPaletteColor" style="flex: 1;">+ Add Color</button>
                </div>
                <div style="margin-bottom: 10px;">
                    <label style="display: block; margin-bottom: 5px; font-size: 12px; color: #e94560;">Palette Name:</label>
                    <input type="text" id="customPaletteName" placeholder="My Custom Palette" style="width: 100%; padding: 6px; background: #1a1a2e; color: #fff; border: 1px solid #533483; border-radius: 3px;">
                </div>
            </div>
            <div class="modal-buttons">
                <button id="saveCustomPalette">Save Palette</button>
                <button id="cancelCustomPalette">Cancel</button>
            </div>
        </div>
    </div>

    <!-- GIF encoding library -->
    <script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js"></script>
    <script type="module" src="src/main.js"></script>
</body>
